(()=>{var D=class{constructor(t){this.t=t,this.i=10**this.t}h(t){return this.t<16?Math.round(t*this.i)/this.i:t}o(t,e){return this.h(t)+","+this.h(e)}},E=class{constructor(t,e){this.x=t,this.y=e}u(){return new E(-this.x,-this.y)}l(t=1){return this._(t/(this.M()||1/0))}g(t){return new E(this.x+t.x,this.y+t.y)}v(t){return new E(this.x-t.x,this.y-t.y)}_(t){return new E(this.x*t,this.y*t)}m(t){return this.x*t.x+this.y*t.y}M(){return Math.sqrt(this.x*this.x+this.y*this.y)}p(t){let e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}},k=class{constructor(t,e){this.C=t,this.L=e}},G=class{constructor(t,e){this.k=t,this.B=e}D(t){let e=this.k;this.B&&(e.unshift(e[e.length-1]),e.push(e[1]));let r=e.length;if(r===0)return[];let n=[new k(e[0])];return this.P(n,t,0,r-1,e[1].v(e[0]),e[r-2].v(e[r-1])),this.B&&(n.shift(),n.pop()),n}P(t,e,r,n,s,i){let h=this.k;if(n-r==1){let m=h[r],l=h[n],v=m.p(l)/3;return void this.R(t,[m,m.g(s.l(v)),l.g(i.l(v)),l])}let a=this.j(r,n),u,p=Math.max(e,e*e),c=!0;for(let m=0;m<=4;m++){let l=this.q(r,n,a,s,i),v=this.A(r,n,l,a);if(v.error<e&&c)return void this.R(t,l);if(u=v.index,v.error>=p)break;c=this.F(r,n,a,l),p=v.error}let o=h[u-1].v(h[u+1]);this.P(t,e,r,u,s,o),this.P(t,e,u,n,o.u(),i)}R(t,e){t[t.length-1].G=e[1].v(e[0]),t.push(new k(e[3],e[2].v(e[3])))}q(t,e,r,n,s){let i=1e-12,h=Math.abs,a=this.k,u=a[t],p=a[e],c=[[0,0],[0,0]],o=[0,0];for(let y=0,g=e-t+1;y<g;y++){let L=r[y],M=1-L,C=3*L*M,B=M*M*M,$=C*M,S=C*L,I=L*L*L,P=n.l($),A=s.l(S),_=a[t+y].v(u._(B+$)).v(p._(S+I));c[0][0]+=P.m(P),c[0][1]+=P.m(A),c[1][0]=c[0][1],c[1][1]+=A.m(A),o[0]+=P.m(_),o[1]+=A.m(_)}let m=c[0][0]*c[1][1]-c[1][0]*c[0][1],l,v;if(h(m)>i){let y=c[0][0]*o[1]-c[1][0]*o[0];l=(o[0]*c[1][1]-o[1]*c[0][1])/m,v=y/m}else{let y=c[0][0]+c[0][1],g=c[1][0]+c[1][1];l=v=h(y)>i?o[0]/y:h(g)>i?o[1]/g:0}let f=p.p(u),b=i*f,w,x;if(l<b||v<b)l=v=f/3;else{let y=p.v(u);w=n.l(l),x=s.l(v),w.m(y)-x.m(y)>f*f&&(l=v=f/3,w=x=null)}return[u,u.g(w||n.l(l)),p.g(x||s.l(v)),p]}F(t,e,r,n){for(let s=t;s<=e;s++)r[s-t]=this.H(n,this.k[s],r[s-t]);for(let s=1,i=r.length;s<i;s++)if(r[s]<=r[s-1])return!1;return!0}H(t,e,r){let n=[],s=[];for(let o=0;o<=2;o++)n[o]=t[o+1].v(t[o])._(3);for(let o=0;o<=1;o++)s[o]=n[o+1].v(n[o])._(2);let i=this.I(3,t,r),h=this.I(2,n,r),a=this.I(1,s,r),u=i.v(e),p=h.m(h)+u.m(a);return(c=p)>=-112e-18&&c<=112e-18?r:r-u.m(h)/p;var c}I(t,e,r){let n=e.slice();for(let s=1;s<=t;s++)for(let i=0;i<=t-s;i++)n[i]=n[i]._(1-r).g(n[i+1]._(r));return n[0]}j(t,e){let r=[0];for(let n=t+1;n<=e;n++)r[n-t]=r[n-t-1]+this.k[n].p(this.k[n-1]);for(let n=1,s=e-t;n<=s;n++)r[n]/=r[s];return r}A(t,e,r,n){let s=Math.floor((e-t+1)/2),i=0;for(let h=t+1;h<e;h++){let a=this.I(3,r,n[h-t]).v(this.k[h]),u=a.x*a.x+a.y*a.y;u>=i&&(i=u,s=h)}return{error:i,index:s}}},q=(d,t={})=>((e,r,n)=>{let s=e.length,i=new D(n),h,a,u,p,c=!0,o=[],m=(l,v)=>{let f=l.C.x,b=l.C.y;if(c)o.push("M"+i.o(f,b)),c=!1;else{let w=f+(l.L?.x??0),x=b+(l.L?.y??0);if(w===f&&x===b&&u===h&&p===a){if(!v){let y=f-h,g=b-a;o.push(y===0?"v"+i.h(g):g===0?"h"+i.h(y):"l"+i.o(y,g))}}else o.push("c"+i.o(u-h,p-a)+" "+i.o(w-h,x-a)+" "+i.o(f-h,b-a))}h=f,a=b,u=f+(l.G?.x??0),p=b+(l.G?.y??0)};if(!s)return"";for(let l=0;l<s;l++)m(e[l]);return r&&s>0&&(m(e[0],!0),o.push("z")),o.join("")})(new G(d.map(e=>new E(e[0],e[1])),t.closed).D(t.tolerance??2.5),t.closed,t.precision??5);var F=class{constructor(t,e){this.path=t;this.distanceThreshold=e?.distanceThreshold??4,this.inertiaFactor=e?.inertiaFactor??.1,this.tolerance=e?.tolerance??2.5,this.precision=e?.precision??5}distanceThreshold;inertiaFactor;tolerance;precision;points=[];wma;_d="";add({x:t,y:e}){let{path:r,points:n,wma:s}=this;if(s){let[i,h]=this.wma=[(s[0]+t)*.5,(s[1]+e)*.5],[a,u]=n[n.length-1],p=Math.hypot(i-a,h-u);if(p>this.distanceThreshold){if(n.length>3){let[c,o]=n[n.length-3],[m,l]=n[n.length-2],v=Math.hypot(a-m,u-l)*this.inertiaFactor,f=v/Math.hypot(m-c,l-o),b=v/p;this._d+=`C${m+(m-c)*f} ${l+(l-o)*f} ${a+(a-i)*b} ${u+(u-h)*b} ${a} ${u}`}r.setAttribute("d",`${this._d}L${i} ${h}`),n.push([i,h])}}else{let i=10**this.precision,h=a=>Math.round(a*i)/i;r.setAttribute("d",`${this._d=`M${h(t)} ${h(e)}`}v0`),n.push(this.wma=[t,e])}return this}end(){let{path:t}=this,e=t.getTotalLength();if(e!==0){let r=[],n=Math.max(.2,Math.min(8,e*.01));for(let i=0;i<e;i+=n){let h=t.getPointAtLength(i);r.push([h.x,h.y])}let s=t.getPointAtLength(e);r.push([s.x,s.y]),t.setAttribute("d",q(r,{tolerance:this.tolerance,precision:this.precision}))}return this}};var T=d=>d.target.closest("svg[data-fluentpath]"),R=+new URLSearchParams(location.search).get("inertia")||.15,V=(()=>{let d=document.createElementNS("http://www.w3.org/2000/svg","circle");return d.setAttribute("stroke","none"),d.setAttribute("fill","red"),d.setAttribute("r","3"),d.setAttribute("opacity","0.2"),d.style.transition="opacity 8s ease-out",t=>{let e=d.cloneNode();return e.setAttribute("cx",t.x),e.setAttribute("cy",t.y),requestAnimationFrame(()=>e.setAttribute("opacity","0.04")),setTimeout(()=>e.remove(),16e3),e}})();addEventListener("pointerdown",d=>{if(d.button!==0)return;let t=T(d);if(!t)return;let e=t.getCTM().a*visualViewport.scale,r=t.getScreenCTM().inverse(),n=o=>{let m=new DOMPoint(o.clientX,o.clientY).matrixTransform(r);return t.appendChild(V(m)),m},s=document.createElementNS("http://www.w3.org/2000/svg","path"),i=new F(s,{distanceThreshold:4/e,tolerance:1/e,precision:e>2?2:1,inertiaFactor:R}).add(n(d)),h=o=>i.add(n(o)),a=o=>{c(),i.add(n(o)).end(),s.dispatchEvent(new CustomEvent("fluentpath:drawend",{bubbles:!0}))},u=o=>o.keyCode===27&&p(),p=()=>{c(),s.remove()},c=()=>{removeEventListener("pointerdown",p,!0),removeEventListener("pointermove",h),removeEventListener("pointerup",a,!0),removeEventListener("pointercancel",p,!0),removeEventListener("keydown",u)};addEventListener("pointerdown",p,!0),addEventListener("pointermove",h),addEventListener("pointerup",a,!0),addEventListener("pointercancel",p,!0),addEventListener("keydown",u),t.appendChild(s).dispatchEvent(new CustomEvent("fluentpath:drawstart",{bubbles:!0})),d.preventDefault()},{passive:!1});"GestureEvent"in self&&(addEventListener("touchmove",d=>d.touches.length===1&&T(d)&&d.preventDefault(),{passive:!1}),addEventListener("touchend",d=>T(d)&&d.preventDefault(),{passive:!1}));})();
